{"remainingRequest":"/Users/diyana.dimitrova/learning/meet-up/node_modules/babel-loader/lib/index.js!/Users/diyana.dimitrova/learning/meet-up/node_modules/eslint-loader/index.js??ref--13-0!/Users/diyana.dimitrova/learning/meet-up/src/store.js","dependencies":[{"path":"/Users/diyana.dimitrova/learning/meet-up/src/store.js","mtime":1563303216830},{"path":"/Users/diyana.dimitrova/learning/meet-up/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/diyana.dimitrova/learning/meet-up/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/diyana.dimitrova/learning/meet-up/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.array.sort\";\nimport _defineProperty from \"/Users/diyana.dimitrova/learning/meet-up/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.reflect.delete-property\";\nimport \"core-js/modules/es6.array.find-index\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { keys.push.apply(keys, Object.getOwnPropertySymbols(object)); } if (enumerableOnly) keys = keys.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { if (i % 2) { var source = arguments[i] != null ? arguments[i] : {}; ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(arguments[i])); } else { ownKeys(arguments[i]).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(arguments[i], key)); }); } } return target; }\n\nimport Vue from 'vue';\nimport Vuex from 'vuex';\nimport * as firebase from 'firebase';\nimport { freemem } from 'os';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    loadedMeetups: [{\n      imageUrl: 'https://upload.wikimedia.org/wikipedia/commons/4/47/New_york_times_square-terabass.jpg',\n      id: 'afajfjadfaadfa323',\n      title: 'Meetup in New York',\n      date: new Date(),\n      location: 'New York',\n      description: 'New York, New York!'\n    }, {\n      imageUrl: 'https://upload.wikimedia.org/wikipedia/commons/7/7a/Paris_-_Blick_vom_gro%C3%9Fen_Triumphbogen.jpg',\n      id: 'aadsfhbkhlk1241',\n      title: 'Meetup in Paris',\n      date: new Date(),\n      location: 'Paris',\n      description: 'It\\'s Paris!'\n    }],\n    user: null,\n    loading: false,\n    error: null\n  },\n  mutations: {\n    registerUserForMeetup: function registerUserForMeetup(state, payload) {\n      var id = payload.id;\n\n      if (state.user.registeredMeetups.findIndex(function (meetup) {\n        return meetup.id === id;\n      }) >= 0) {\n        return;\n      }\n\n      state.user.registeredMeetups.push(id);\n      state.user.fbKeys[id] = payload.fbKey;\n    },\n    unregisterUserForMeetup: function unregisterUserForMeetup(state, payload) {\n      var registeredMeetups = state.user.registeredMeetups;\n      registeredMeetups.splice(registeredMeetups.findIndex(function (meetup) {\n        return meetup.id === payload;\n      }), 1);\n      Reflect.deleteProperty(state.user.fbKeys, payload);\n    },\n    setLoadedMeetups: function setLoadedMeetups(state, payload) {\n      state.loadedMeetups = payload;\n    },\n    createMeetup: function createMeetup(state, payload) {\n      state.loadedMeetups.push(payload);\n    },\n    updateMeetup: function updateMeetup(state, payload) {\n      var meetup = state.loadedMeetups.find(function (meetup) {\n        return meetup.id === payload.id;\n      });\n\n      if (payload.title) {\n        meetup.title = payload.title;\n      }\n\n      if (payload.description) {\n        meetup.description = payload.description;\n      }\n\n      if (payload.date) {\n        meetup.date = payload.date;\n      }\n    },\n    setUser: function setUser(state, payload) {\n      state.user = payload;\n    },\n    setLoading: function setLoading(state, payload) {\n      state.loading = payload;\n    },\n    setError: function setError(state, payload) {\n      state.error = payload;\n    },\n    clearError: function clearError(state) {\n      state.error = null;\n    }\n  },\n  actions: {\n    registerUserForMeetup: function registerUserForMeetup(_ref, payload) {\n      var commit = _ref.commit,\n          getters = _ref.getters;\n      commit('setLoading', true);\n      var user = getters.user;\n      firebase.database().ref('/users/' + user.id).child('/registrations/').push(payload).then(function (data) {\n        commit('setLoading', false);\n        commit('registerUserForMeetup', {\n          id: payload,\n          fbKey: data.key\n        });\n      }).catch(function (error) {\n        console.log(error);\n        commit('setLoading', false);\n      });\n    },\n    unregisterUserForMeetup: function unregisterUserForMeetup(_ref2, payload) {\n      var commit = _ref2.commit,\n          getters = _ref2.getters;\n      commit('setLoading', true);\n      var user = getters.user;\n\n      if (!user.fbKeys) {\n        return;\n      }\n\n      var fbKey = user.fbKeys[payload];\n      firebase.database().ref('/users/' + user.id + '/registrations/').child(fbKey).remove().then(function () {\n        commit('setLoading', false);\n        commit('unregisterUserForMeetup', payload);\n      }).catch(function (error) {\n        console.log(error);\n        commit('setLoading', false);\n      });\n    },\n    loadMeetups: function loadMeetups(_ref3) {\n      var commit = _ref3.commit;\n      commit('setLoading', true);\n      firebase.database().ref('meetups').once('value').then(function (data) {\n        var meetups = [];\n        var obj = data.val();\n\n        for (var key in obj) {\n          meetups.push({\n            id: key,\n            title: obj[key].title,\n            description: obj[key].description,\n            imageUrl: obj[key].imageUrl,\n            date: obj[key].date,\n            location: obj[key].location,\n            creatorId: obj[key].creatorId\n          });\n        }\n\n        commit('setLoadedMeetups', meetups);\n        commit('setLoading', false);\n      }).catch(function (error) {\n        console.log(error);\n        commit('setLoading', false);\n      });\n    },\n    createMeetup: function createMeetup(_ref4, payload) {\n      var commit = _ref4.commit,\n          getters = _ref4.getters;\n      var meetup = {\n        title: payload.title,\n        location: payload.location,\n        description: payload.description,\n        date: payload.date.toISOString(),\n        creatorId: getters.user.id\n      };\n      var imageUrl;\n      var key;\n      firebase.database().ref('meetups').push(meetup).then(function (data) {\n        key = data.key;\n        return key;\n      }).then(function (key) {\n        var filename = payload.image.name;\n        var ext = filename.slice(filename.lastIndexOf('.'));\n        return firebase.storage().ref('meetups/' + key + '.' + ext).put(payload.image);\n      }).then(function (fileData) {\n        return fileData.ref.getDownloadURL().then(function (_imageUrl) {\n          imageUrl = _imageUrl;\n          return imageUrl;\n        });\n      }).then(function (imageUrl) {\n        return firebase.database().ref('meetups').child(key).update({\n          imageUrl: imageUrl\n        });\n      }).then(function () {\n        commit('createMeetup', _objectSpread({}, meetup, {\n          imageUrl: imageUrl,\n          id: key\n        }));\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    updateMeetup: function updateMeetup(_ref5, payload) {\n      var commit = _ref5.commit;\n      commit('setLoading', true);\n      var updateObj = {};\n\n      if (payload.title) {\n        updateObj.title = payload.title;\n      }\n\n      if (payload.description) {\n        updateObj.description = payload.description;\n      }\n\n      if (payload.date) {\n        updateObj.date = payload.date;\n      }\n\n      firebase.database().ref('meetups').child(payload.id).update(updateObj).then(function () {\n        commit('setLoading', false);\n        commit('updateMeetup', payload);\n      }).catch(function (error) {\n        console.log(error);\n        commit('setLoading', false);\n      });\n    },\n    signUserUp: function signUserUp(_ref6, payload) {\n      var commit = _ref6.commit;\n      commit('setLoading', true);\n      commit('clearError');\n      firebase.auth().createUserWithEmailAndPassword(payload.email, payload.password).then(function (user) {\n        commit('setLoading', false);\n        var newUser = {\n          id: user.uid,\n          registeredMeetups: [],\n          fbKeys: {}\n        };\n        commit('setUser', newUser);\n      }).catch(function (error) {\n        commit('setLoading', false);\n        commit('setError', error);\n        console.log(error);\n      });\n    },\n    signUserIn: function signUserIn(_ref7, payload) {\n      var commit = _ref7.commit;\n      commit('setLoading', true);\n      commit('clearError');\n      firebase.auth().signInWithEmailAndPassword(payload.email, payload.password).then(function (user) {\n        commit('setLoading', false);\n        var newUser = {\n          id: user.uid,\n          registeredMeetups: []\n        };\n        commit('setUser', newUser);\n      }).catch(function (error) {\n        commit('setLoading', false);\n        commit('setError', error);\n        console.log(error);\n      });\n    },\n    autoSignIn: function autoSignIn(_ref8, payload) {\n      var commit = _ref8.commit;\n      commit('setUser', {\n        id: payload.uid,\n        registeredMeetups: [],\n        fbKeys: {}\n      });\n    },\n    fetchUserData: function fetchUserData(_ref9, payload) {\n      var commit = _ref9.commit,\n          getters = _ref9.getters;\n      commit('setLoading', true);\n      firebase.database().ref('/users/' + this.getters.user.id + '/registrations/').once('value').then(function (data) {\n        var dataPairs = data.val();\n        var registeredMeetups = [];\n        var swappedPairs = {};\n\n        for (var key in dataPairs) {\n          registeredMeetups.push(dataPairs[key]);\n          swappedPairs[dataPairs[key]] = key;\n        }\n\n        var updatedUser = {\n          id: getters.user.id,\n          registeredMeetups: registeredMeetups,\n          fbKeys: swappedPairs\n        };\n        commit('setLoading', false);\n        commit('setUser', updatedUser);\n      }).catch(function (error) {\n        console.log(error);\n        commit('setLoading', false);\n      });\n    },\n    logout: function logout(_ref10) {\n      var commit = _ref10.commit;\n      firebase.auth().signOut();\n      commit('setUser', null);\n    },\n    clearError: function clearError(_ref11) {\n      var commit = _ref11.commit;\n      commit('clearError');\n    }\n  },\n  getters: {\n    loadedMeetups: function loadedMeetups(state) {\n      return state.loadedMeetups.sort(function (meetupA, meetupB) {\n        return meetupA.date > meetupB.date;\n      });\n    },\n    featuredMeetups: function featuredMeetups(state, getters) {\n      return getters.loadedMeetups.slice(0, 5);\n    },\n    loadedMeetup: function loadedMeetup(state) {\n      return function (meetupId) {\n        return state.loadedMeetups.find(function (meetup) {\n          return meetup.id === meetupId;\n        });\n      };\n    },\n    user: function user(state) {\n      return state.user;\n    },\n    loading: function loading(state) {\n      return state.loading;\n    },\n    error: function error(state) {\n      return state.error;\n    }\n  }\n});",{"version":3,"sources":["/Users/diyana.dimitrova/learning/meet-up/src/store.js"],"names":["Vue","Vuex","firebase","freemem","use","Store","state","loadedMeetups","imageUrl","id","title","date","Date","location","description","user","loading","error","mutations","registerUserForMeetup","payload","registeredMeetups","findIndex","meetup","push","fbKeys","fbKey","unregisterUserForMeetup","splice","Reflect","deleteProperty","setLoadedMeetups","createMeetup","updateMeetup","find","setUser","setLoading","setError","clearError","actions","commit","getters","database","ref","child","then","data","key","catch","console","log","remove","loadMeetups","once","meetups","obj","val","creatorId","toISOString","filename","image","name","ext","slice","lastIndexOf","storage","put","fileData","getDownloadURL","_imageUrl","update","updateObj","signUserUp","auth","createUserWithEmailAndPassword","email","password","newUser","uid","signUserIn","signInWithEmailAndPassword","autoSignIn","fetchUserData","dataPairs","swappedPairs","updatedUser","logout","signOut","sort","meetupA","meetupB","featuredMeetups","loadedMeetup","meetupId"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAO,KAAKC,QAAZ,MAA0B,UAA1B;AACA,SAASC,OAAT,QAAwB,IAAxB;AAEAH,GAAG,CAACI,GAAJ,CAAQH,IAAR;AAEA,eAAe,IAAIA,IAAI,CAACI,KAAT,CAAe;AAC5BC,EAAAA,KAAK,EAAE;AACLC,IAAAA,aAAa,EAAE,CACb;AACEC,MAAAA,QAAQ,EAAE,wFADZ;AAEEC,MAAAA,EAAE,EAAE,mBAFN;AAGEC,MAAAA,KAAK,EAAE,oBAHT;AAIEC,MAAAA,IAAI,EAAE,IAAIC,IAAJ,EAJR;AAKEC,MAAAA,QAAQ,EAAE,UALZ;AAMEC,MAAAA,WAAW,EAAE;AANf,KADa,EASb;AACEN,MAAAA,QAAQ,EAAE,oGADZ;AAEEC,MAAAA,EAAE,EAAE,iBAFN;AAGEC,MAAAA,KAAK,EAAE,iBAHT;AAIEC,MAAAA,IAAI,EAAE,IAAIC,IAAJ,EAJR;AAKEC,MAAAA,QAAQ,EAAE,OALZ;AAMEC,MAAAA,WAAW,EAAE;AANf,KATa,CADV;AAmBLC,IAAAA,IAAI,EAAE,IAnBD;AAoBLC,IAAAA,OAAO,EAAE,KApBJ;AAqBLC,IAAAA,KAAK,EAAE;AArBF,GADqB;AAwB5BC,EAAAA,SAAS,EAAE;AACTC,IAAAA,qBADS,iCACcb,KADd,EACqBc,OADrB,EAC8B;AACrC,UAAMX,EAAE,GAAGW,OAAO,CAACX,EAAnB;;AACA,UAAIH,KAAK,CAACS,IAAN,CAAWM,iBAAX,CAA6BC,SAA7B,CAAuC,UAAAC,MAAM;AAAA,eAAIA,MAAM,CAACd,EAAP,KAAcA,EAAlB;AAAA,OAA7C,KAAsE,CAA1E,EAA6E;AAC3E;AACD;;AACDH,MAAAA,KAAK,CAACS,IAAN,CAAWM,iBAAX,CAA6BG,IAA7B,CAAkCf,EAAlC;AACAH,MAAAA,KAAK,CAACS,IAAN,CAAWU,MAAX,CAAkBhB,EAAlB,IAAwBW,OAAO,CAACM,KAAhC;AACD,KARQ;AASTC,IAAAA,uBATS,mCASgBrB,KAThB,EASuBc,OATvB,EASgC;AACvC,UAAMC,iBAAiB,GAAGf,KAAK,CAACS,IAAN,CAAWM,iBAArC;AACAA,MAAAA,iBAAiB,CAACO,MAAlB,CAAyBP,iBAAiB,CAACC,SAAlB,CAA4B,UAAAC,MAAM;AAAA,eAAIA,MAAM,CAACd,EAAP,KAAcW,OAAlB;AAAA,OAAlC,CAAzB,EAAuF,CAAvF;AACAS,MAAAA,OAAO,CAACC,cAAR,CAAuBxB,KAAK,CAACS,IAAN,CAAWU,MAAlC,EAA0CL,OAA1C;AACD,KAbQ;AAcTW,IAAAA,gBAdS,4BAcSzB,KAdT,EAcgBc,OAdhB,EAcyB;AAChCd,MAAAA,KAAK,CAACC,aAAN,GAAsBa,OAAtB;AACD,KAhBQ;AAiBTY,IAAAA,YAjBS,wBAiBK1B,KAjBL,EAiBYc,OAjBZ,EAiBqB;AAC5Bd,MAAAA,KAAK,CAACC,aAAN,CAAoBiB,IAApB,CAAyBJ,OAAzB;AACD,KAnBQ;AAoBTa,IAAAA,YApBS,wBAoBK3B,KApBL,EAoBYc,OApBZ,EAoBqB;AAC5B,UAAMG,MAAM,GAAGjB,KAAK,CAACC,aAAN,CAAoB2B,IAApB,CAAyB,UAAAX,MAAM,EAAI;AAChD,eAAOA,MAAM,CAACd,EAAP,KAAcW,OAAO,CAACX,EAA7B;AACD,OAFc,CAAf;;AAGA,UAAIW,OAAO,CAACV,KAAZ,EAAmB;AACjBa,QAAAA,MAAM,CAACb,KAAP,GAAeU,OAAO,CAACV,KAAvB;AACD;;AACD,UAAIU,OAAO,CAACN,WAAZ,EAAyB;AACvBS,QAAAA,MAAM,CAACT,WAAP,GAAqBM,OAAO,CAACN,WAA7B;AACD;;AACD,UAAIM,OAAO,CAACT,IAAZ,EAAkB;AAChBY,QAAAA,MAAM,CAACZ,IAAP,GAAcS,OAAO,CAACT,IAAtB;AACD;AACF,KAjCQ;AAkCTwB,IAAAA,OAlCS,mBAkCA7B,KAlCA,EAkCOc,OAlCP,EAkCgB;AACvBd,MAAAA,KAAK,CAACS,IAAN,GAAaK,OAAb;AACD,KApCQ;AAqCTgB,IAAAA,UArCS,sBAqCG9B,KArCH,EAqCUc,OArCV,EAqCmB;AAC1Bd,MAAAA,KAAK,CAACU,OAAN,GAAgBI,OAAhB;AACD,KAvCQ;AAwCTiB,IAAAA,QAxCS,oBAwCC/B,KAxCD,EAwCQc,OAxCR,EAwCiB;AACxBd,MAAAA,KAAK,CAACW,KAAN,GAAcG,OAAd;AACD,KA1CQ;AA2CTkB,IAAAA,UA3CS,sBA2CGhC,KA3CH,EA2CU;AACjBA,MAAAA,KAAK,CAACW,KAAN,GAAc,IAAd;AACD;AA7CQ,GAxBiB;AAuE5BsB,EAAAA,OAAO,EAAE;AACPpB,IAAAA,qBADO,uCACqCC,OADrC,EAC8C;AAAA,UAA5BoB,MAA4B,QAA5BA,MAA4B;AAAA,UAApBC,OAAoB,QAApBA,OAAoB;AACnDD,MAAAA,MAAM,CAAC,YAAD,EAAe,IAAf,CAAN;AACA,UAAMzB,IAAI,GAAG0B,OAAO,CAAC1B,IAArB;AACAb,MAAAA,QAAQ,CAACwC,QAAT,GAAoBC,GAApB,CAAwB,YAAY5B,IAAI,CAACN,EAAzC,EAA6CmC,KAA7C,CAAmD,iBAAnD,EACGpB,IADH,CACQJ,OADR,EAEGyB,IAFH,CAEQ,UAAAC,IAAI,EAAI;AACZN,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACAA,QAAAA,MAAM,CAAC,uBAAD,EAA0B;AAAE/B,UAAAA,EAAE,EAAEW,OAAN;AAAeM,UAAAA,KAAK,EAAEoB,IAAI,CAACC;AAA3B,SAA1B,CAAN;AACD,OALH,EAMGC,KANH,CAMS,UAAA/B,KAAK,EAAI;AACdgC,QAAAA,OAAO,CAACC,GAAR,CAAYjC,KAAZ;AACAuB,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACD,OATH;AAUD,KAdM;AAePb,IAAAA,uBAfO,0CAeuCP,OAfvC,EAegD;AAAA,UAA5BoB,MAA4B,SAA5BA,MAA4B;AAAA,UAApBC,OAAoB,SAApBA,OAAoB;AACrDD,MAAAA,MAAM,CAAC,YAAD,EAAe,IAAf,CAAN;AACA,UAAMzB,IAAI,GAAG0B,OAAO,CAAC1B,IAArB;;AACA,UAAI,CAACA,IAAI,CAACU,MAAV,EAAkB;AAChB;AACD;;AACD,UAAMC,KAAK,GAAGX,IAAI,CAACU,MAAL,CAAYL,OAAZ,CAAd;AACAlB,MAAAA,QAAQ,CAACwC,QAAT,GAAoBC,GAApB,CAAwB,YAAY5B,IAAI,CAACN,EAAjB,GAAsB,iBAA9C,EAAiEmC,KAAjE,CAAuElB,KAAvE,EACGyB,MADH,GAEGN,IAFH,CAEQ,YAAM;AACVL,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACAA,QAAAA,MAAM,CAAC,yBAAD,EAA4BpB,OAA5B,CAAN;AACD,OALH,EAMG4B,KANH,CAMS,UAAA/B,KAAK,EAAI;AACdgC,QAAAA,OAAO,CAACC,GAAR,CAAYjC,KAAZ;AACAuB,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACD,OATH;AAUD,KAhCM;AAiCPY,IAAAA,WAjCO,8BAiCkB;AAAA,UAAVZ,MAAU,SAAVA,MAAU;AACvBA,MAAAA,MAAM,CAAC,YAAD,EAAe,IAAf,CAAN;AACAtC,MAAAA,QAAQ,CAACwC,QAAT,GAAoBC,GAApB,CAAwB,SAAxB,EAAmCU,IAAnC,CAAwC,OAAxC,EACGR,IADH,CACQ,UAACC,IAAD,EAAU;AACd,YAAMQ,OAAO,GAAG,EAAhB;AACA,YAAMC,GAAG,GAAGT,IAAI,CAACU,GAAL,EAAZ;;AACA,aAAK,IAAIT,GAAT,IAAgBQ,GAAhB,EAAqB;AACnBD,UAAAA,OAAO,CAAC9B,IAAR,CAAa;AACXf,YAAAA,EAAE,EAAEsC,GADO;AAEXrC,YAAAA,KAAK,EAAE6C,GAAG,CAACR,GAAD,CAAH,CAASrC,KAFL;AAGXI,YAAAA,WAAW,EAAEyC,GAAG,CAACR,GAAD,CAAH,CAASjC,WAHX;AAIXN,YAAAA,QAAQ,EAAE+C,GAAG,CAACR,GAAD,CAAH,CAASvC,QAJR;AAKXG,YAAAA,IAAI,EAAE4C,GAAG,CAACR,GAAD,CAAH,CAASpC,IALJ;AAMXE,YAAAA,QAAQ,EAAE0C,GAAG,CAACR,GAAD,CAAH,CAASlC,QANR;AAOX4C,YAAAA,SAAS,EAAEF,GAAG,CAACR,GAAD,CAAH,CAASU;AAPT,WAAb;AASD;;AACDjB,QAAAA,MAAM,CAAC,kBAAD,EAAqBc,OAArB,CAAN;AACAd,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACD,OAjBH,EAkBGQ,KAlBH,CAmBI,UAAC/B,KAAD,EAAW;AACTgC,QAAAA,OAAO,CAACC,GAAR,CAAYjC,KAAZ;AACAuB,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACD,OAtBL;AAwBD,KA3DM;AA4DPR,IAAAA,YA5DO,+BA4D4BZ,OA5D5B,EA4DqC;AAAA,UAA5BoB,MAA4B,SAA5BA,MAA4B;AAAA,UAApBC,OAAoB,SAApBA,OAAoB;AAC1C,UAAMlB,MAAM,GAAG;AACbb,QAAAA,KAAK,EAAEU,OAAO,CAACV,KADF;AAEbG,QAAAA,QAAQ,EAAEO,OAAO,CAACP,QAFL;AAGbC,QAAAA,WAAW,EAAEM,OAAO,CAACN,WAHR;AAIbH,QAAAA,IAAI,EAAES,OAAO,CAACT,IAAR,CAAa+C,WAAb,EAJO;AAKbD,QAAAA,SAAS,EAAEhB,OAAO,CAAC1B,IAAR,CAAaN;AALX,OAAf;AAOA,UAAID,QAAJ;AACA,UAAIuC,GAAJ;AACA7C,MAAAA,QAAQ,CAACwC,QAAT,GAAoBC,GAApB,CAAwB,SAAxB,EAAmCnB,IAAnC,CAAwCD,MAAxC,EACGsB,IADH,CACQ,UAACC,IAAD,EAAU;AACdC,QAAAA,GAAG,GAAGD,IAAI,CAACC,GAAX;AACA,eAAOA,GAAP;AACD,OAJH,EAKGF,IALH,CAKQ,UAAAE,GAAG,EAAI;AACX,YAAMY,QAAQ,GAAGvC,OAAO,CAACwC,KAAR,CAAcC,IAA/B;AACA,YAAMC,GAAG,GAAGH,QAAQ,CAACI,KAAT,CAAeJ,QAAQ,CAACK,WAAT,CAAqB,GAArB,CAAf,CAAZ;AACA,eAAO9D,QAAQ,CAAC+D,OAAT,GAAmBtB,GAAnB,CAAuB,aAAaI,GAAb,GAAmB,GAAnB,GAAyBe,GAAhD,EAAqDI,GAArD,CAAyD9C,OAAO,CAACwC,KAAjE,CAAP;AACD,OATH,EAUGf,IAVH,CAUQ,UAAAsB,QAAQ,EAAI;AAChB,eAAOA,QAAQ,CAACxB,GAAT,CAAayB,cAAb,GAA8BvB,IAA9B,CAAmC,UAAUwB,SAAV,EAAqB;AAC7D7D,UAAAA,QAAQ,GAAG6D,SAAX;AACA,iBAAO7D,QAAP;AACD,SAHM,CAAP;AAID,OAfH,EAgBGqC,IAhBH,CAgBQ,UAAArC,QAAQ,EAAI;AAChB,eAAON,QAAQ,CAACwC,QAAT,GAAoBC,GAApB,CAAwB,SAAxB,EAAmCC,KAAnC,CAAyCG,GAAzC,EAA8CuB,MAA9C,CAAqD;AAAE9D,UAAAA,QAAQ,EAAEA;AAAZ,SAArD,CAAP;AACD,OAlBH,EAmBGqC,IAnBH,CAmBQ,YAAM;AACVL,QAAAA,MAAM,CAAC,cAAD,oBACDjB,MADC;AAEJf,UAAAA,QAAQ,EAAEA,QAFN;AAGJC,UAAAA,EAAE,EAAEsC;AAHA,WAAN;AAKD,OAzBH,EA0BGC,KA1BH,CA0BS,UAAC/B,KAAD,EAAW;AAChBgC,QAAAA,OAAO,CAACC,GAAR,CAAYjC,KAAZ;AACD,OA5BH;AA6BD,KAnGM;AAoGPgB,IAAAA,YApGO,+BAoGmBb,OApGnB,EAoG4B;AAAA,UAAnBoB,MAAmB,SAAnBA,MAAmB;AACjCA,MAAAA,MAAM,CAAC,YAAD,EAAe,IAAf,CAAN;AACA,UAAM+B,SAAS,GAAG,EAAlB;;AACA,UAAInD,OAAO,CAACV,KAAZ,EAAmB;AACjB6D,QAAAA,SAAS,CAAC7D,KAAV,GAAkBU,OAAO,CAACV,KAA1B;AACD;;AACD,UAAIU,OAAO,CAACN,WAAZ,EAAyB;AACvByD,QAAAA,SAAS,CAACzD,WAAV,GAAwBM,OAAO,CAACN,WAAhC;AACD;;AACD,UAAIM,OAAO,CAACT,IAAZ,EAAkB;AAChB4D,QAAAA,SAAS,CAAC5D,IAAV,GAAiBS,OAAO,CAACT,IAAzB;AACD;;AACDT,MAAAA,QAAQ,CAACwC,QAAT,GAAoBC,GAApB,CAAwB,SAAxB,EAAmCC,KAAnC,CAAyCxB,OAAO,CAACX,EAAjD,EAAqD6D,MAArD,CAA4DC,SAA5D,EACG1B,IADH,CACQ,YAAM;AACVL,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACAA,QAAAA,MAAM,CAAC,cAAD,EAAiBpB,OAAjB,CAAN;AACD,OAJH,EAKG4B,KALH,CAKS,UAAA/B,KAAK,EAAI;AACdgC,QAAAA,OAAO,CAACC,GAAR,CAAYjC,KAAZ;AACAuB,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACD,OARH;AASD,KAzHM;AA0HPgC,IAAAA,UA1HO,6BA0HiBpD,OA1HjB,EA0H0B;AAAA,UAAnBoB,MAAmB,SAAnBA,MAAmB;AAC/BA,MAAAA,MAAM,CAAC,YAAD,EAAe,IAAf,CAAN;AACAA,MAAAA,MAAM,CAAC,YAAD,CAAN;AACAtC,MAAAA,QAAQ,CAACuE,IAAT,GAAgBC,8BAAhB,CAA+CtD,OAAO,CAACuD,KAAvD,EAA8DvD,OAAO,CAACwD,QAAtE,EACG/B,IADH,CAEI,UAAA9B,IAAI,EAAI;AACNyB,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACA,YAAMqC,OAAO,GAAG;AACdpE,UAAAA,EAAE,EAAEM,IAAI,CAAC+D,GADK;AAEdzD,UAAAA,iBAAiB,EAAE,EAFL;AAGdI,UAAAA,MAAM,EAAE;AAHM,SAAhB;AAKAe,QAAAA,MAAM,CAAC,SAAD,EAAYqC,OAAZ,CAAN;AACD,OAVL,EAYG7B,KAZH,CAaI,UAAA/B,KAAK,EAAI;AACPuB,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACAA,QAAAA,MAAM,CAAC,UAAD,EAAavB,KAAb,CAAN;AACAgC,QAAAA,OAAO,CAACC,GAAR,CAAYjC,KAAZ;AACD,OAjBL;AAmBD,KAhJM;AAiJP8D,IAAAA,UAjJO,6BAiJiB3D,OAjJjB,EAiJ0B;AAAA,UAAnBoB,MAAmB,SAAnBA,MAAmB;AAC/BA,MAAAA,MAAM,CAAC,YAAD,EAAe,IAAf,CAAN;AACAA,MAAAA,MAAM,CAAC,YAAD,CAAN;AACAtC,MAAAA,QAAQ,CAACuE,IAAT,GAAgBO,0BAAhB,CAA2C5D,OAAO,CAACuD,KAAnD,EAA0DvD,OAAO,CAACwD,QAAlE,EACG/B,IADH,CAEI,UAAA9B,IAAI,EAAI;AACNyB,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACA,YAAMqC,OAAO,GAAG;AACdpE,UAAAA,EAAE,EAAEM,IAAI,CAAC+D,GADK;AAEdzD,UAAAA,iBAAiB,EAAE;AAFL,SAAhB;AAIAmB,QAAAA,MAAM,CAAC,SAAD,EAAYqC,OAAZ,CAAN;AACD,OATL,EAWG7B,KAXH,CAYI,UAAA/B,KAAK,EAAI;AACPuB,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACAA,QAAAA,MAAM,CAAC,UAAD,EAAavB,KAAb,CAAN;AACAgC,QAAAA,OAAO,CAACC,GAAR,CAAYjC,KAAZ;AACD,OAhBL;AAkBD,KAtKM;AAuKPgE,IAAAA,UAvKO,6BAuKiB7D,OAvKjB,EAuK0B;AAAA,UAAnBoB,MAAmB,SAAnBA,MAAmB;AAC/BA,MAAAA,MAAM,CAAC,SAAD,EAAY;AAChB/B,QAAAA,EAAE,EAAEW,OAAO,CAAC0D,GADI;AAEhBzD,QAAAA,iBAAiB,EAAE,EAFH;AAGhBI,QAAAA,MAAM,EAAE;AAHQ,OAAZ,CAAN;AAKD,KA7KM;AA8KPyD,IAAAA,aA9KO,gCA8K6B9D,OA9K7B,EA8KsC;AAAA,UAA5BoB,MAA4B,SAA5BA,MAA4B;AAAA,UAApBC,OAAoB,SAApBA,OAAoB;AAC3CD,MAAAA,MAAM,CAAC,YAAD,EAAe,IAAf,CAAN;AACAtC,MAAAA,QAAQ,CAACwC,QAAT,GAAoBC,GAApB,CAAwB,YAAY,KAAKF,OAAL,CAAa1B,IAAb,CAAkBN,EAA9B,GAAmC,iBAA3D,EACG4C,IADH,CACQ,OADR,EAEGR,IAFH,CAEQ,UAAAC,IAAI,EAAI;AACZ,YAAMqC,SAAS,GAAGrC,IAAI,CAACU,GAAL,EAAlB;AACA,YAAInC,iBAAiB,GAAG,EAAxB;AACA,YAAI+D,YAAY,GAAG,EAAnB;;AACA,aAAK,IAAIrC,GAAT,IAAgBoC,SAAhB,EAA2B;AACzB9D,UAAAA,iBAAiB,CAACG,IAAlB,CAAuB2D,SAAS,CAACpC,GAAD,CAAhC;AACAqC,UAAAA,YAAY,CAACD,SAAS,CAACpC,GAAD,CAAV,CAAZ,GAA+BA,GAA/B;AACD;;AACD,YAAMsC,WAAW,GAAG;AAClB5E,UAAAA,EAAE,EAAEgC,OAAO,CAAC1B,IAAR,CAAaN,EADC;AAElBY,UAAAA,iBAAiB,EAAEA,iBAFD;AAGlBI,UAAAA,MAAM,EAAE2D;AAHU,SAApB;AAKA5C,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACAA,QAAAA,MAAM,CAAC,SAAD,EAAY6C,WAAZ,CAAN;AACD,OAjBH,EAkBGrC,KAlBH,CAkBS,UAAA/B,KAAK,EAAI;AACdgC,QAAAA,OAAO,CAACC,GAAR,CAAYjC,KAAZ;AACAuB,QAAAA,MAAM,CAAC,YAAD,EAAe,KAAf,CAAN;AACD,OArBH;AAsBD,KAtMM;AAuMP8C,IAAAA,MAvMO,0BAuMa;AAAA,UAAV9C,MAAU,UAAVA,MAAU;AAClBtC,MAAAA,QAAQ,CAACuE,IAAT,GAAgBc,OAAhB;AACA/C,MAAAA,MAAM,CAAC,SAAD,EAAY,IAAZ,CAAN;AACD,KA1MM;AA2MPF,IAAAA,UA3MO,8BA2MiB;AAAA,UAAVE,MAAU,UAAVA,MAAU;AACtBA,MAAAA,MAAM,CAAC,YAAD,CAAN;AACD;AA7MM,GAvEmB;AAsR5BC,EAAAA,OAAO,EAAE;AACPlC,IAAAA,aADO,yBACQD,KADR,EACe;AACpB,aAAOA,KAAK,CAACC,aAAN,CAAoBiF,IAApB,CAAyB,UAACC,OAAD,EAAUC,OAAV,EAAsB;AACpD,eAAOD,OAAO,CAAC9E,IAAR,GAAe+E,OAAO,CAAC/E,IAA9B;AACD,OAFM,CAAP;AAGD,KALM;AAMPgF,IAAAA,eANO,2BAMUrF,KANV,EAMiBmC,OANjB,EAM0B;AAC/B,aAAOA,OAAO,CAAClC,aAAR,CAAsBwD,KAAtB,CAA4B,CAA5B,EAA+B,CAA/B,CAAP;AACD,KARM;AASP6B,IAAAA,YATO,wBASOtF,KATP,EASc;AACnB,aAAO,UAACuF,QAAD,EAAc;AACnB,eAAOvF,KAAK,CAACC,aAAN,CAAoB2B,IAApB,CAAyB,UAACX,MAAD,EAAY;AAC1C,iBAAOA,MAAM,CAACd,EAAP,KAAcoF,QAArB;AACD,SAFM,CAAP;AAGD,OAJD;AAKD,KAfM;AAgBP9E,IAAAA,IAhBO,gBAgBDT,KAhBC,EAgBM;AACX,aAAOA,KAAK,CAACS,IAAb;AACD,KAlBM;AAmBPC,IAAAA,OAnBO,mBAmBEV,KAnBF,EAmBS;AACd,aAAOA,KAAK,CAACU,OAAb;AACD,KArBM;AAsBPC,IAAAA,KAtBO,iBAsBAX,KAtBA,EAsBO;AACZ,aAAOA,KAAK,CAACW,KAAb;AACD;AAxBM;AAtRmB,CAAf,CAAf","sourcesContent":["import Vue from 'vue'\nimport Vuex from 'vuex'\nimport * as firebase from 'firebase'\nimport { freemem } from 'os'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  state: {\n    loadedMeetups: [\n      {\n        imageUrl: 'https://upload.wikimedia.org/wikipedia/commons/4/47/New_york_times_square-terabass.jpg',\n        id: 'afajfjadfaadfa323',\n        title: 'Meetup in New York',\n        date: new Date(),\n        location: 'New York',\n        description: 'New York, New York!'\n      },\n      {\n        imageUrl: 'https://upload.wikimedia.org/wikipedia/commons/7/7a/Paris_-_Blick_vom_gro%C3%9Fen_Triumphbogen.jpg',\n        id: 'aadsfhbkhlk1241',\n        title: 'Meetup in Paris',\n        date: new Date(),\n        location: 'Paris',\n        description: 'It\\'s Paris!'\n      }\n    ],\n    user: null,\n    loading: false,\n    error: null\n  },\n  mutations: {\n    registerUserForMeetup (state, payload) {\n      const id = payload.id\n      if (state.user.registeredMeetups.findIndex(meetup => meetup.id === id) >= 0) {\n        return\n      }\n      state.user.registeredMeetups.push(id)\n      state.user.fbKeys[id] = payload.fbKey\n    },\n    unregisterUserForMeetup (state, payload) {\n      const registeredMeetups = state.user.registeredMeetups\n      registeredMeetups.splice(registeredMeetups.findIndex(meetup => meetup.id === payload), 1)\n      Reflect.deleteProperty(state.user.fbKeys, payload)\n    },\n    setLoadedMeetups (state, payload) {\n      state.loadedMeetups = payload\n    },\n    createMeetup (state, payload) {\n      state.loadedMeetups.push(payload)\n    },\n    updateMeetup (state, payload) {\n      const meetup = state.loadedMeetups.find(meetup => {\n        return meetup.id === payload.id\n      })\n      if (payload.title) {\n        meetup.title = payload.title\n      }\n      if (payload.description) {\n        meetup.description = payload.description\n      }\n      if (payload.date) {\n        meetup.date = payload.date\n      }\n    },\n    setUser (state, payload) {\n      state.user = payload\n    },\n    setLoading (state, payload) {\n      state.loading = payload\n    },\n    setError (state, payload) {\n      state.error = payload\n    },\n    clearError (state) {\n      state.error = null\n    }\n  },\n  actions: {\n    registerUserForMeetup ({ commit, getters }, payload) {\n      commit('setLoading', true)\n      const user = getters.user\n      firebase.database().ref('/users/' + user.id).child('/registrations/')\n        .push(payload)\n        .then(data => {\n          commit('setLoading', false)\n          commit('registerUserForMeetup', { id: payload, fbKey: data.key })\n        })\n        .catch(error => {\n          console.log(error)\n          commit('setLoading', false)\n        })\n    },\n    unregisterUserForMeetup ({ commit, getters }, payload) {\n      commit('setLoading', true)\n      const user = getters.user\n      if (!user.fbKeys) {\n        return\n      }\n      const fbKey = user.fbKeys[payload]\n      firebase.database().ref('/users/' + user.id + '/registrations/').child(fbKey)\n        .remove()\n        .then(() => {\n          commit('setLoading', false)\n          commit('unregisterUserForMeetup', payload)\n        })\n        .catch(error => {\n          console.log(error)\n          commit('setLoading', false)\n        })\n    },\n    loadMeetups ({ commit }) {\n      commit('setLoading', true)\n      firebase.database().ref('meetups').once('value')\n        .then((data) => {\n          const meetups = []\n          const obj = data.val()\n          for (let key in obj) {\n            meetups.push({\n              id: key,\n              title: obj[key].title,\n              description: obj[key].description,\n              imageUrl: obj[key].imageUrl,\n              date: obj[key].date,\n              location: obj[key].location,\n              creatorId: obj[key].creatorId\n            })\n          }\n          commit('setLoadedMeetups', meetups)\n          commit('setLoading', false)\n        })\n        .catch(\n          (error) => {\n            console.log(error)\n            commit('setLoading', false)\n          }\n        )\n    },\n    createMeetup ({ commit, getters }, payload) {\n      const meetup = {\n        title: payload.title,\n        location: payload.location,\n        description: payload.description,\n        date: payload.date.toISOString(),\n        creatorId: getters.user.id\n      }\n      let imageUrl\n      let key\n      firebase.database().ref('meetups').push(meetup)\n        .then((data) => {\n          key = data.key\n          return key\n        })\n        .then(key => {\n          const filename = payload.image.name\n          const ext = filename.slice(filename.lastIndexOf('.'))\n          return firebase.storage().ref('meetups/' + key + '.' + ext).put(payload.image)\n        })\n        .then(fileData => {\n          return fileData.ref.getDownloadURL().then(function (_imageUrl) {\n            imageUrl = _imageUrl\n            return imageUrl\n          })\n        })\n        .then(imageUrl => {\n          return firebase.database().ref('meetups').child(key).update({ imageUrl: imageUrl })\n        })\n        .then(() => {\n          commit('createMeetup', {\n            ...meetup,\n            imageUrl: imageUrl,\n            id: key\n          })\n        })\n        .catch((error) => {\n          console.log(error)\n        })\n    },\n    updateMeetup ({ commit }, payload) {\n      commit('setLoading', true)\n      const updateObj = {}\n      if (payload.title) {\n        updateObj.title = payload.title\n      }\n      if (payload.description) {\n        updateObj.description = payload.description\n      }\n      if (payload.date) {\n        updateObj.date = payload.date\n      }\n      firebase.database().ref('meetups').child(payload.id).update(updateObj)\n        .then(() => {\n          commit('setLoading', false)\n          commit('updateMeetup', payload)\n        })\n        .catch(error => {\n          console.log(error)\n          commit('setLoading', false)\n        })\n    },\n    signUserUp ({ commit }, payload) {\n      commit('setLoading', true)\n      commit('clearError')\n      firebase.auth().createUserWithEmailAndPassword(payload.email, payload.password)\n        .then(\n          user => {\n            commit('setLoading', false)\n            const newUser = {\n              id: user.uid,\n              registeredMeetups: [],\n              fbKeys: {}\n            }\n            commit('setUser', newUser)\n          }\n        )\n        .catch(\n          error => {\n            commit('setLoading', false)\n            commit('setError', error)\n            console.log(error)\n          }\n        )\n    },\n    signUserIn ({ commit }, payload) {\n      commit('setLoading', true)\n      commit('clearError')\n      firebase.auth().signInWithEmailAndPassword(payload.email, payload.password)\n        .then(\n          user => {\n            commit('setLoading', false)\n            const newUser = {\n              id: user.uid,\n              registeredMeetups: []\n            }\n            commit('setUser', newUser)\n          }\n        )\n        .catch(\n          error => {\n            commit('setLoading', false)\n            commit('setError', error)\n            console.log(error)\n          }\n        )\n    },\n    autoSignIn ({ commit }, payload) {\n      commit('setUser', {\n        id: payload.uid,\n        registeredMeetups: [],\n        fbKeys: {}\n      })\n    },\n    fetchUserData ({ commit, getters }, payload) {\n      commit('setLoading', true)\n      firebase.database().ref('/users/' + this.getters.user.id + '/registrations/')\n        .once('value')\n        .then(data => {\n          const dataPairs = data.val()\n          let registeredMeetups = []\n          let swappedPairs = {}\n          for (let key in dataPairs) {\n            registeredMeetups.push(dataPairs[key])\n            swappedPairs[dataPairs[key]] = key\n          }\n          const updatedUser = {\n            id: getters.user.id,\n            registeredMeetups: registeredMeetups,\n            fbKeys: swappedPairs\n          }\n          commit('setLoading', false)\n          commit('setUser', updatedUser)\n        })\n        .catch(error => {\n          console.log(error)\n          commit('setLoading', false)\n        })\n    },\n    logout ({ commit }) {\n      firebase.auth().signOut()\n      commit('setUser', null)\n    },\n    clearError ({ commit }) {\n      commit('clearError')\n    }\n  },\n  getters: {\n    loadedMeetups (state) {\n      return state.loadedMeetups.sort((meetupA, meetupB) => {\n        return meetupA.date > meetupB.date\n      })\n    },\n    featuredMeetups (state, getters) {\n      return getters.loadedMeetups.slice(0, 5)\n    },\n    loadedMeetup (state) {\n      return (meetupId) => {\n        return state.loadedMeetups.find((meetup) => {\n          return meetup.id === meetupId\n        })\n      }\n    },\n    user (state) {\n      return state.user\n    },\n    loading (state) {\n      return state.loading\n    },\n    error (state) {\n      return state.error\n    }\n  }\n})\n"]}]}