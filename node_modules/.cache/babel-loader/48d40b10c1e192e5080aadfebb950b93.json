{"remainingRequest":"/Users/diyana.dimitrova/learning/meet-up/node_modules/babel-loader/lib/index.js!/Users/diyana.dimitrova/learning/meet-up/node_modules/eslint-loader/index.js??ref--13-0!/Users/diyana.dimitrova/learning/meet-up/src/store/user/index.js","dependencies":[{"path":"/Users/diyana.dimitrova/learning/meet-up/src/store/user/index.js","mtime":1563304588086},{"path":"/Users/diyana.dimitrova/learning/meet-up/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/diyana.dimitrova/learning/meet-up/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/diyana.dimitrova/learning/meet-up/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.reflect.delete-property\";\nimport \"core-js/modules/es6.array.find-index\";\nimport * as firebase from 'firebase';\nexport default {\n  state: {\n    user: null\n  },\n  mutations: {\n    registerUserForMeetup: function registerUserForMeetup(state, payload) {\n      var id = payload.id;\n\n      if (state.user.registeredMeetups.findIndex(function (meetup) {\n        return meetup.id === id;\n      }) >= 0) {\n        return;\n      }\n\n      state.user.registeredMeetups.push(id);\n      state.user.fbKeys[id] = payload.fbKey;\n    },\n    unregisterUserForMeetup: function unregisterUserForMeetup(state, payload) {\n      var registeredMeetups = state.user.registeredMeetups;\n      registeredMeetups.splice(registeredMeetups.findIndex(function (meetup) {\n        return meetup.id === payload;\n      }), 1);\n      Reflect.deleteProperty(state.user.fbKeys, payload);\n    },\n    setUser: function setUser(state, payload) {\n      state.user = payload;\n    }\n  },\n  actions: {\n    registerUserForMeetup: function registerUserForMeetup(_ref, payload) {\n      var commit = _ref.commit,\n          getters = _ref.getters;\n      commit('setLoading', true);\n      var user = getters.user;\n      firebase.database().ref('/users/' + user.id).child('/registrations/').push(payload).then(function (data) {\n        commit('setLoading', false);\n        commit('registerUserForMeetup', {\n          id: payload,\n          fbKey: data.key\n        });\n      }).catch(function (error) {\n        console.log(error);\n        commit('setLoading', false);\n      });\n    },\n    unregisterUserForMeetup: function unregisterUserForMeetup(_ref2, payload) {\n      var commit = _ref2.commit,\n          getters = _ref2.getters;\n      commit('setLoading', true);\n      var user = getters.user;\n\n      if (!user.fbKeys) {\n        return;\n      }\n\n      var fbKey = user.fbKeys[payload];\n      firebase.database().ref('/users/' + user.id + '/registrations/').child(fbKey).remove().then(function () {\n        commit('setLoading', false);\n        commit('unregisterUserForMeetup', payload);\n      }).catch(function (error) {\n        console.log(error);\n        commit('setLoading', false);\n      });\n    },\n    signUserUp: function signUserUp(_ref3, payload) {\n      var commit = _ref3.commit;\n      commit('setLoading', true);\n      commit('clearError');\n      firebase.auth().createUserWithEmailAndPassword(payload.email, payload.password).then(function (user) {\n        commit('setLoading', false);\n        var newUser = {\n          id: user.uid,\n          registeredMeetups: [],\n          fbKeys: {}\n        };\n        commit('setUser', newUser);\n      }).catch(function (error) {\n        commit('setLoading', false);\n        commit('setError', error);\n        console.log(error);\n      });\n    },\n    signUserIn: function signUserIn(_ref4, payload) {\n      var commit = _ref4.commit;\n      commit('setLoading', true);\n      commit('clearError');\n      firebase.auth().signInWithEmailAndPassword(payload.email, payload.password).then(function (user) {\n        commit('setLoading', false);\n        var newUser = {\n          id: user.uid,\n          registeredMeetups: []\n        };\n        commit('setUser', newUser);\n      }).catch(function (error) {\n        commit('setLoading', false);\n        commit('setError', error);\n        console.log(error);\n      });\n    },\n    autoSignIn: function autoSignIn(_ref5, payload) {\n      var commit = _ref5.commit;\n      commit('setUser', {\n        id: payload.uid,\n        registeredMeetups: [],\n        fbKeys: {}\n      });\n    },\n    fetchUserData: function fetchUserData(_ref6, payload) {\n      var commit = _ref6.commit,\n          getters = _ref6.getters;\n      commit('setLoading', true);\n      firebase.database().ref('/users/' + this.getters.user.id + '/registrations/').once('value').then(function (data) {\n        var dataPairs = data.val();\n        var registeredMeetups = [];\n        var swappedPairs = {};\n\n        for (var key in dataPairs) {\n          registeredMeetups.push(dataPairs[key]);\n          swappedPairs[dataPairs[key]] = key;\n        }\n\n        var updatedUser = {\n          id: getters.user.id,\n          registeredMeetups: registeredMeetups,\n          fbKeys: swappedPairs\n        };\n        commit('setLoading', false);\n        commit('setUser', updatedUser);\n      }).catch(function (error) {\n        console.log(error);\n        commit('setLoading', false);\n      });\n    },\n    logout: function logout(_ref7) {\n      var commit = _ref7.commit;\n      firebase.auth().signOut();\n      commit('setUser', null);\n    }\n  },\n  getters: {\n    user: function user(state) {\n      return state.user;\n    }\n  }\n};",{"version":3,"sources":["/Users/diyana.dimitrova/learning/meet-up/src/store/user/index.js"],"names":["firebase","state","user","mutations","registerUserForMeetup","payload","id","registeredMeetups","findIndex","meetup","push","fbKeys","fbKey","unregisterUserForMeetup","splice","Reflect","deleteProperty","setUser","actions","commit","getters","database","ref","child","then","data","key","catch","error","console","log","remove","signUserUp","auth","createUserWithEmailAndPassword","email","password","newUser","uid","signUserIn","signInWithEmailAndPassword","autoSignIn","fetchUserData","once","dataPairs","val","swappedPairs","updatedUser","logout","signOut"],"mappings":"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","sourcesContent":["import * as firebase from 'firebase'\n\nexport default {\n  state: {\n    user: null\n  },\n  mutations: {\n    registerUserForMeetup (state, payload) {\n      const id = payload.id\n      if (state.user.registeredMeetups.findIndex(meetup => meetup.id === id) >= 0) {\n        return\n      }\n      state.user.registeredMeetups.push(id)\n      state.user.fbKeys[id] = payload.fbKey\n    },\n    unregisterUserForMeetup (state, payload) {\n      const registeredMeetups = state.user.registeredMeetups\n      registeredMeetups.splice(registeredMeetups.findIndex(meetup => meetup.id === payload), 1)\n      Reflect.deleteProperty(state.user.fbKeys, payload)\n    },\n    setUser (state, payload) {\n      state.user = payload\n    }\n  },\n  actions: {\n    registerUserForMeetup ({ commit, getters }, payload) {\n      commit('setLoading', true)\n      const user = getters.user\n      firebase.database().ref('/users/' + user.id).child('/registrations/')\n        .push(payload)\n        .then(data => {\n          commit('setLoading', false)\n          commit('registerUserForMeetup', { id: payload, fbKey: data.key })\n        })\n        .catch(error => {\n          console.log(error)\n          commit('setLoading', false)\n        })\n    },\n    unregisterUserForMeetup ({ commit, getters }, payload) {\n      commit('setLoading', true)\n      const user = getters.user\n      if (!user.fbKeys) {\n        return\n      }\n      const fbKey = user.fbKeys[payload]\n      firebase.database().ref('/users/' + user.id + '/registrations/').child(fbKey)\n        .remove()\n        .then(() => {\n          commit('setLoading', false)\n          commit('unregisterUserForMeetup', payload)\n        })\n        .catch(error => {\n          console.log(error)\n          commit('setLoading', false)\n        })\n    },\n    signUserUp ({ commit }, payload) {\n      commit('setLoading', true)\n      commit('clearError')\n      firebase.auth().createUserWithEmailAndPassword(payload.email, payload.password)\n        .then(\n          user => {\n            commit('setLoading', false)\n            const newUser = {\n              id: user.uid,\n              registeredMeetups: [],\n              fbKeys: {}\n            }\n            commit('setUser', newUser)\n          }\n        )\n        .catch(\n          error => {\n            commit('setLoading', false)\n            commit('setError', error)\n            console.log(error)\n          }\n        )\n    },\n    signUserIn ({ commit }, payload) {\n      commit('setLoading', true)\n      commit('clearError')\n      firebase.auth().signInWithEmailAndPassword(payload.email, payload.password)\n        .then(\n          user => {\n            commit('setLoading', false)\n            const newUser = {\n              id: user.uid,\n              registeredMeetups: []\n            }\n            commit('setUser', newUser)\n          }\n        )\n        .catch(\n          error => {\n            commit('setLoading', false)\n            commit('setError', error)\n            console.log(error)\n          }\n        )\n    },\n    autoSignIn ({ commit }, payload) {\n      commit('setUser', {\n        id: payload.uid,\n        registeredMeetups: [],\n        fbKeys: {}\n      })\n    },\n    fetchUserData ({ commit, getters }, payload) {\n      commit('setLoading', true)\n      firebase.database().ref('/users/' + this.getters.user.id + '/registrations/')\n        .once('value')\n        .then(data => {\n          const dataPairs = data.val()\n          let registeredMeetups = []\n          let swappedPairs = {}\n          for (let key in dataPairs) {\n            registeredMeetups.push(dataPairs[key])\n            swappedPairs[dataPairs[key]] = key\n          }\n          const updatedUser = {\n            id: getters.user.id,\n            registeredMeetups: registeredMeetups,\n            fbKeys: swappedPairs\n          }\n          commit('setLoading', false)\n          commit('setUser', updatedUser)\n        })\n        .catch(error => {\n          console.log(error)\n          commit('setLoading', false)\n        })\n    },\n    logout ({ commit }) {\n      firebase.auth().signOut()\n      commit('setUser', null)\n    }\n  },\n  getters: {\n    user (state) {\n      return state.user\n    }\n  }\n}\n"]}]}